{% extends "auctions/layout.html" %}

{% block body %}
<div style="max-width: 800px; margin: auto; padding: 20px; border: 1px solid rgba(0, 0, 0, 0.1); box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); border-radius: 8px;">
    <h2 style="text-align: center;">{{ listing.title }}</h2>
    {% if listing.image_url %}
        <div style="text-align: center;">
            <img src="{{ listing.image_url }}" alt="{{ listing.title }}" style="max-width: 400px; height: auto; border-radius: 4px; margin-bottom: 20px;">
        </div>
    {% endif %}
    <p><strong>Description:</strong> {{ listing.description }}</p>
    <p><strong>Starting Bid:</strong> ${{ listing.starting_bid }}</p>
    <p><strong>Category:</strong> {{ listing.category }}</p>
    <p><strong>Created At:</strong> {{ listing.created_at }}</p>

    <!-- Display bids -->
    <div>
        <h3>Bids</h3>
        {% if bids %}
            <ul>
            {% for bid in bids %}
                <li>${{ bid.amount }} by {{ bid.user.username }} on {{ bid.created_at }}</li>
            {% endfor %}
            </ul>
        {% else %}
            <p>No bids yet.</p>
        {% endif %}
    </div>

    {% if user.is_authenticated and user != listing.user %}
        <form action="{% url 'place_bid' listing.id %}" method="post">
            {% csrf_token %}
            <div>
                <label for="bid_amount">Your Bid:</label>
                <input type="number" name="bid_amount" id="bid_amount" min="{{ listing.starting_bid }}" step="0.01" required>
                <button type="submit">Place Bid</button>
            </div>
        </form>
    {% endif %}

    {% if user.is_authenticated %}
        <form action="{% url 'toggle_watchlist' listing.id %}" method="post" style="text-align: center; margin-top: 20px;">
            {% csrf_token %}
            {% if is_in_watchlist %}
                <button type="submit" style="padding: 10px 20px; background-color: #ff4d4d; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove from Watchlist</button>
            {% else %}
                <button type="submit" style="padding: 10px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Add to Watchlist</button>
            {% endif %}
        </form>
    {% endif %}
</div>
{% endblock %}
